"use strict";(self.webpackChunke_pos_point_dashboard=self.webpackChunke_pos_point_dashboard||[]).push([[186],{7186:(L,v,n)=>{n.d(v,{H:()=>D});var c=n(4499),h=n(2997),s=n(4753),p=n(7384),m=n(2835),S=n(4970),g=n(4924),_=n(5237),l=n(3668),T=n(5474),I=n(6129),$=n(950);let D=(()=>{class P{constructor(o,d,u){this.httpService=o,this.utilService=d,this.productService=u,this.categories$=new c.X({data:[],loading:!0,loaded:!1}),this.selectedCategory$=new c.X({item:void 0}),this.selectedCategory=void 0,this.categories=[],this.subCategories$=new c.X([]),this.subCategories=[]}getAll(){return this.categories.length?(0,h.of)(this.categories):(this.categories$.next({data:[],loading:!0,loaded:!1}),this.httpService.requestCell(g.$l.CATEGORIES,_.m.GET).pipe((0,s.U)(({data:o})=>o.map(d=>this.utilService.convertStringPropertyToNumber(d,["id","locationId","terminalId","parentCategoryCode"]))),(0,p.b)(o=>{const d=[],u=[];o.forEach(b=>{isNaN(b.parentCategoryCode)?d.push(b):u.push(b)}),this.categories=d,this.subCategories=u,this.categories$.next({data:o,loading:!1,loaded:!0}),this.selectedCategory=o[0],this.selectedCategory$.next({item:o[0]}),this.subCategories$.next(this.subCategories)}),(0,m.K)(o=>(this.categories$.next({data:[],loading:!1,loaded:!1,error:o}),(0,h.of)([]))),(0,S.d)()))}selectCategory(o){this.selectedCategory=o,this.selectedCategory$.next({item:this.selectedCategory}),this.productService.selectedProduct$.next({product:void 0})}countTotalProductInsideCategory(o){return this.productService.products$.pipe((0,s.U)(({data:d})=>d.filter(u=>u.category==o.id).length))}isCategoryHaveSubCategories(o){return this.getSubCategories(o).pipe((0,s.U)(d=>0!==d.length))}getSubCategories(o){return this.subCategories$.pipe((0,s.U)(d=>d.filter(u=>u.parentCategoryCode==o.id)))}deleteCategory(o){this.selectedCategory&&this.selectedCategory.id==o.id&&this.selectedCategory$.next({item:void 0}),this.productService.deleteCategoryProducts(o);const d=this.categories.indexOf(o);this.categories.splice(d,1),this.categories$.next({data:this.categories,loaded:!0,loading:!1})}getSingleCategory(o){return this.categories.find(d=>d.id===o)}get categorySkeletonLoader$(){return(0,h.of)(Array(10).fill(""))}get isCategoriesEmpty$(){return this.categories$.pipe((0,s.U)(o=>!o.data.length&&o.loaded))}get isCategoriesLoading$(){return this.categories$.pipe((0,s.U)(o=>o.loading))}get isCategoriesLoaded$(){return this.categories$.pipe((0,s.U)(o=>o.loaded))}}return P.\u0275fac=function(o){return new(o||P)(l.LFG(T.O),l.LFG(I.f),l.LFG($.M))},P.\u0275prov=l.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})()},950:(L,v,n)=>{n.d(v,{M:()=>He});var c=n(4499),h=n(2997),s=n(4753),p=n(7384),m=n(2835),S=n(4970),g=n(4924),_=n(5237),l=n(3668),T=n(5474),I=n(6129),$=Math.ceil,D=Math.max;var u="object"==typeof global&&global&&global.Object===Object&&global,B="object"==typeof self&&self&&self.Object===Object&&self,K=(u||B||Function("return this")()).Symbol,M=Object.prototype,W=M.hasOwnProperty,X=M.toString,C=K?K.toStringTag:void 0;var k=Object.prototype.toString;var A=K?K.toStringTag:void 0;const j=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":A&&A in Object(e)?function(e){var r=W.call(e,C),t=e[C];try{e[C]=void 0;var i=!0}catch(f){}var a=X.call(e);return i&&(r?e[C]=t:delete e[C]),a}(e):function(e){return k.call(e)}(e)},O=function(e){var r=typeof e;return null!=e&&("object"==r||"function"==r)},le=function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){if(!O(e))return!1;var r=j(e);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r}(e)};var fe=/^(?:0|[1-9]\d*)$/;const F=function(e,r,t){if(!O(t))return!1;var i=typeof r;return!!("number"==i?le(t)&&function(e,r){var t=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==t||"symbol"!=t&&fe.test(e))&&e>-1&&e%1==0&&e<r}(r,t.length):"string"==i&&r in t)&&function(e,r){return e===r||e!=e&&r!=r}(t[r],e)};var pe=/\s/;var ye=/^\s+/;const Se=function(e){return e&&e.slice(0,function(e){for(var r=e.length;r--&&pe.test(e.charAt(r)););return r}(e)+1).replace(ye,"")};var Te=/^[-+]0x[0-9a-f]+$/i,Ie=/^0b[01]+$/i,$e=/^0o[0-7]+$/i,De=parseInt;const Le=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==j(e)}(e))return NaN;if(O(e)){var r="function"==typeof e.valueOf?e.valueOf():e;e=O(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=Se(e);var t=Ie.test(e);return t||$e.test(e)?De(e.slice(2),t?2:8):Te.test(e)?NaN:+e};var N=1/0;const E=function(e){return e?(e=Le(e))===N||e===-N?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};const Re=function(r,t,i){return i&&"number"!=typeof i&&F(r,t,i)&&(t=i=void 0),r=E(r),void 0===t?(t=r,r=0):t=E(t),function(e,r,t,i){for(var a=-1,f=D($((r-e)/(t||1)),0),y=Array(f);f--;)y[i?f:++a]=e,e+=t;return y}(r,t,i=void 0===i?r<t?1:-1:E(i),undefined)};var Ne=Math.floor,Be=Math.random;var We=parseFloat,Xe=Math.min,we=Math.random;const Ye=function(e,r,t){if(t&&"boolean"!=typeof t&&F(e,r,t)&&(r=t=void 0),void 0===t&&("boolean"==typeof r?(t=r,r=void 0):"boolean"==typeof e&&(t=e,e=void 0)),void 0===e&&void 0===r?(e=0,r=1):(e=E(e),void 0===r?(r=e,e=0):r=E(r)),e>r){var i=e;e=r,r=i}if(t||e%1||r%1){var a=we();return Xe(e+a*(r-e+We("1e-"+((a+"").length-1))),r)}return function(e,r){return e+Ne(Be()*(r-e+1))}(e,r)};let ke=(()=>{class e{constructor(){}range(t){return Re(t)}random(t,i,a=!1){return Ye(t,i,a)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),He=(()=>{class e{constructor(t,i,a){this.httpService=t,this.utilService=i,this.lodashService=a,this.products$=new c.X({data:[],loading:!0,loaded:!1}),this.selectedProduct$=new c.X({product:void 0}),this.editingProduct$=new c.X({product:void 0,isFormInvalid:!1}),this.productFormStatus$=new c.X({isSubmitting:!1}),this.selectedProduct=void 0,this.products=[]}getAll(){return this.products.length?(this.products$.next({loaded:!0,loading:!1,data:this.products}),(0,h.of)(this.products)):(this.products$.next({data:[],loading:!0,loaded:!1}),this.httpService.requestCell(g.eX.PRODUCTS,_.m.GET).pipe((0,s.U)(({data:t})=>t.map(i=>this.utilService.convertStringPropertyToNumber(i,["id","locationId","terminalId"]))),(0,s.U)(t=>t.map(i=>this.addProductImageIfDoNotExits(i))),(0,p.b)(t=>{this.products$.next({data:t,loading:!1,loaded:!0}),this.products=t,this.selectedProduct=t[0],this.selectedProduct$.next({product:this.selectedProduct}),this.editingProduct$.next({product:t[0],isFormInvalid:!1})}),(0,m.K)(t=>(this.products$.next({data:[],loading:!1,loaded:!1,error:t}),(0,h.of)([]))),(0,S.d)()))}getProductForCategory(t){return this.products$.pipe((0,s.U)(i=>i.data.filter(a=>a.category==t)))}searchProducts(t){let i=[];this.products.forEach(a=>{a.product_Name.toLowerCase().includes(t.toLowerCase())&&i.push(a)}),this.products$.next({loaded:!0,loading:!1,data:i})}selectProductForEdit(t){this.selectedProduct=t,this.selectedProduct$.next({product:this.selectedProduct}),this.editingProduct$.next({product:t,isFormInvalid:!1})}updateProduct(t){return this.httpService.requestCell(g.eX.PRODUCTS,_.m.PUT).pipe((0,p.b)(({data:i})=>{if(console.log(i),i){const a=this.products.findIndex(f=>f.id==t.id);this.productFormStatus$.next({isSubmitting:!1}),this.products[a]=t,this.products$.next({data:this.products,loaded:!0,loading:!1})}}))}changeStatus(t,i){return this.httpService.requestCell(g.eX.PRODUCTS,_.m.PUT,{status:i}).pipe((0,p.b)(({data:a})=>{if(a){const f=this.products.findIndex(y=>y.id==t.id);this.products[f]=Object.assign(Object.assign({},t),{status:i}),this.products$.next({data:this.products})}}))}deleteProduct(t){return this.httpService.requestCell(g.eX.PRODUCTS,_.m.DELETE,t.id).pipe((0,p.b)(()=>{this.selectedProduct&&this.selectedProduct.id==t.id&&(this.selectedProduct=void 0,this.selectedProduct$.next({product:this.selectedProduct}),this.editingProduct$.next({product:void 0,isFormInvalid:!1}));const i=this.products.findIndex(a=>a.id==t.id);this.products.splice(i,1),this.products$.next({data:this.products,loaded:!0,loading:!1})}))}deleteCategoryProducts(t){this.selectedProduct&&this.selectedProduct.category==t.id&&(this.selectedProduct=void 0,this.selectedProduct$.next({product:this.selectedProduct}),this.editingProduct$.next({product:void 0,isFormInvalid:!1})),this.products=this.products.filter(i=>i.category==t.id),this.products$.next({data:this.products,loaded:!0,loading:!1})}get productSkeletonLoader$(){return(0,h.of)(Array(10).fill(""))}get isProductsEmpty$(){return this.products$.pipe((0,s.U)(t=>!(t.data.length&&(null==t?void 0:t.loaded))))}get isProductsLoading$(){return this.products$.pipe((0,s.U)(t=>!!(null==t?void 0:t.loading)))}get isProductsLoaded$(){return this.products$.pipe((0,s.U)(t=>!!(null==t?void 0:t.loaded)))}get isProductSelected$(){return this.selectedProduct$.pipe((0,s.U)(t=>null!=t.product))}get isProductFormSubmitting$(){return this.productFormStatus$.pipe((0,s.U)(({isSubmitting:t})=>t))}addProductImageIfDoNotExits(t){let i=Object.assign(Object.assign({},t),{product_Image:[{fullUrl:"https://picsum.photos/200",alt:"demo image"}]});return this.lodashService.range(this.lodashService.random(1,5)).forEach((a,f)=>{var y;null===(y=i.product_Image)||void 0===y||y.push({fullUrl:`https://picsum.photos/${200+f+1}`,alt:"demo image"})}),i}static get productObj(){return{product_Name:"",barcode:"",barcode_Type:"",status:!1,brand:0,category:0,sub_Category:0,transaction_Unit:0,product_Group:0,department:0,business_Location:0,alert_Quantity:0,tax_Method:0,tax_Rate:0,supplier:0,tax_On_Sale:!1,tax_On_Purchase:!1,purchasePriceExcludingTax:0,purchasePriceIncludingTax:0,saleMargin:0,salePriceExcTax:0,merge_Item:!1,age_Restricted:!1,price_Levels:!1,open_Customization_Window:!1,plU_Is_Negative:!1,condiment_PLU:!1,enable_SEL_Printing:!1,open_Price_PLU:!1,open_Text_PLU:!1,exclude_From_Discount:!1,exclude_Service_Charges:!1,serial_Product:!1,show_Portion_Front:!1,allow:!1,allow_Negative_Stock:!1,unit_Price_Override:!1,short_Name:"",sku:"",expiry_Date:new Date,expiry_Alert_Days:0,expiry_Alert_Type:0,currentOffier:"",currentOfferSalePrice:0,offerStartDate:new Date,offerEndDate:new Date,offerDays:"",manufacturer_Part_Number:"",supplier_Part_Number:"",warrenty_Days:0,model_Number:"",weight:0,description:"",product_Image:"",current_Stock:0,reordering_Quantity:0,minimum_Stock:0,maximum_Stock:0,label_Formate:"",packed_By_Date:new Date,use_By_Date:new Date,sell_By_Date:new Date,lot:0,not_For_Selling_Quantity:0,contains_Allergen:!1,show_Allergen_On_Cart:!1,show_Allergen_On_Secondary_Dispaly:!1,show_Allergen_PopUp:!1,rack:"",row:"",position:"",front_Location:0,back_Location:0,plU_Code:"",sale_Price:0,yield:"",product_Type:"",base_Unit:"",transaction_Unit_Multiplier:"",sale_Account:"",maintain_Stock:!1,inventory_Account:"",purchase_Price:0,expense_Account:"",purchase_Discount_Account:0,foriegn_Language_Name:"",kitchen_Print_Description:"",isNew:!1,isUpdated:!1,createdBy:"",createdOn:new Date,updatedBy:"",updatedOn:new Date}}}return e.\u0275fac=function(t){return new(t||e)(l.LFG(T.O),l.LFG(I.f),l.LFG(ke))},e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},6129:(L,v,n)=>{n.d(v,{f:()=>h});var c=n(3668);let h=(()=>{class s{constructor(){}convertStringPropertyToNumber(m,S){let g={};return S.forEach(_=>{g[_]=parseInt(m[_])}),Object.assign(Object.assign({},m),g)}}return s.\u0275fac=function(m){return new(m||s)},s.\u0275prov=c.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()}}]);